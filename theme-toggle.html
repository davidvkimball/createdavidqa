<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="darkreader-lock">
<link rel="icon" href="https://david.qa/images/icon-sun.gif">
<title>theme toggle • david.qa</title>
<meta name="description" content="get a dark/light theme toggle for your site">
<meta name="author" content="David V. Kimball">
<link rel="stylesheet" href="style.css" type="text/css">

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-F49NPPR47D"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-F49NPPR47D');
</script>

<!-- OpenGraph -->
<meta property="og:title" content="theme toggle • david.qa">
<meta property="og:description" content="get a dark/light theme toggle for your site">
<meta property="og:image" content="https://david.qa/images/opengraph.png">
<meta property="og:image:alt" content="3 boxes total, two boxes are Q+A-styled questions in light mode box, grayed out, and one box in dark mode with the brand name and tagline. Content: Q: What's a link? An item that points to another location. david.qa - answers to your creative website questions. Q: What's a website? A set of related web pages located under a single domain name.">
<meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="630" />
<meta property="og:image:type" content="image/png" />
<meta property="og:url" content="https://david.qa" />

<!-- Twitter card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@davidvkimball">

</head>
<body>
<!-- Body -->
<div id="wrapper">

<!-- Header -->
<header>
<div class="header-inner">
<!-- Site Name -->
<h1><a href="/">david.qa</a></h1>
answers to your creative website questions
  <div class="theme-switcher">
    <img src="https://david.qa/images/light.gif" alt="Theme Toggle" id="theme-toggle"> 
  </div>
</div>
</header><!-- End of Header -->

<!-- Menu -->
<div id="open"><span id="open-icon"></span></div>

<div id="menu">
<nav class="cf">
<ul>

<li><a href="/">home</a>
<li><a href="/resources">resources</a>
<li><a href="/blog">blog</a>
<li><a href="/about">about</a>

</ul>
</nav>
</div><!-- End of Menu -->

<!-- Main -->
<div id="content">

<h2>Dark / light mode toggle</h2>

<p>Get a theme toggle for your website, like the one on this site.</p>
<p>If you want something incredibly simple, you can check out this <a href="https://www.w3schools.com/howto/howto_js_toggle_dark_mode.asp">W3 Schools page</a>.</p>
<p>However, there are a few problems with this method. It's not comprehensive, won't remember your selection if you navigate to another page or refresh, and also doesn't take the user's dark/light mode system preferences into account.</p>
<p>So we want to create a theme toggle that:</p>
<ol>
  <li>Is site-wide</li>
  <li>Defaults to the user's specified preference</li>
  <li>Remember's the user's selection and persists throughout their session</li>
</ol>
<p>So I created something that did that. For an example, you can <span class="marker">click the button below</span> to see a preview:</p>
<p><a href="https://example.david.qa/" target="_blank"><img src="images/example-website-button.gif"></a></p>
<b>Toggle Button HTML</b> (place wherever you want on your site): <br>
<span class="full-width-code"><textarea readonly="" cols="150" rows="6" onclick="this.setSelectionRange(0, this.value.length)">&lt;!-- Dark/Light Theme Toggle Button --&gt;
&lt;div class="theme-switcher"&gt;
  &lt;img src="https://david.qa/images/light.gif" alt="Theme toggle" id="theme-toggle"&gt; 
&lt;/div&gt;</textarea></span>
<h3>What's happening here?</h3>
<p>You're adding a button to your website users can click to toggle the dark/light theme styles we'll be defining with CSS soon. You can use any image you like, or you can use the two images below with their current names, <span class="inline-markup">light.gif</span> and <span class="inline-markup">dark.gif</span>.</p>
<p>Save these images to your images folder:</p>
<p><img src="images/light.gif"> <img src="images/dark.gif"></p>
<p>If you choose to use your own images, remember to replace <span class="inline-markup">https://david.qa/images/light.gif</span> with the URL location of your version.</p>

<b>Toggle Button CSS</b> (add to your stylesheet file): <br>
<span class="full-width-code"><textarea readonly="" cols="150" rows="6" onclick="this.setSelectionRange(0, this.value.length)">/*  Light/Dark theme toggle
  ------------------------------ */

/* Toggle button and icon */

.theme-switcher {
/* Change this to position: absolute; if you want to keep it at the top */
position: fixed;
top: 10px;
right: 10px;
    }

#theme-toggle {
cursor: pointer;
    }

.dark-mode #theme-toggle {
content: url('https://david.qa/images/dark.gif'); 
    }
</textarea></span>

<h3>What's happening here?</h3>
<p>You're positioning the button to go in the top right corner and telling it to swap it's image when clicked.</p>
<p>Remember to replace <span class="inline-markup">https://david.qa/images/dark.gif</span> with the URL location of your versions of the images!</p>
<b>Dark Theme Styles CSS</b> (add to your stylesheet file): <br>
<span class="full-width-code"><textarea readonly="" cols="150" rows="6" onclick="this.setSelectionRange(0, this.value.length)">
  /* Dark theme styles */


.dark-mode {
background-color: #1e1f22;
color: #fff;
    }

.dark-mode #header {
background-color: #313338;
background-image: var(--header-image-dark);
}

.dark-mode aside {
    background-color: #2b2d31;
    color: #fff;
}

.dark-mode main {
    background-color: #313338;
    color: #fff;
}

.dark-mode .box {
    background-color: #fff;
    color: #000;
}

.dark-mode h1,
.dark-mode h2,
.dark-mode h3 {
    color: #fff;
}

.dark-mode strong {
    color: #dadada;
}
</textarea></span>
<h3>What's happening here?</h3>
<p>Here you're defining your dark mode styles, assuming your current theme is light by default.</p>
<p>This may not line up with your theme 1:1, so a good rule of thumb is to identify elements, classes, and ids that may have a color set, 
  and then create a <span class="inline-markup">.dark-mode</span> variant of it and change the color or background-color value to something else.
</p>
<b>Toggle function JavaScript</b> (create or add to a .js file): <br>
<span class="full-width-code"><textarea readonly="" cols="150" rows="6" onclick="this.setSelectionRange(0, this.value.length)">// Dark/Light Mode Theme Toggle from david.qa 
  document.addEventListener('DOMContentLoaded', function() {
      // Get system preference
      const darkModeMediaQuery = window.matchMedia('(prefers-color-scheme: dark)');
      const systemPrefersDark = darkModeMediaQuery.matches;
      console.log(`System prefers dark: ${systemPrefersDark}`);
  
      // Get stored preference
      const storedPref = sessionStorage.getItem('theme');
      console.log(`Stored preference: ${storedPref}`);
  
      // Default to system pref
      let currentTheme = systemPrefersDark ? 'dark' : 'light';
  
      // If stored pref, use that
      if (storedPref) {
          currentTheme = storedPref;
      }
      console.log(`Current theme: ${currentTheme}`);
  
      // Toggle button
      const toggle = document.getElementById('theme-toggle');
  
      function setTheme() {
          const isDark = currentTheme === 'dark';
  
          if (isDark) {
              document.body.classList.add('dark-mode');
          } else {
              document.body.classList.remove('dark-mode');
          }
  
          // Update image
          const imgSrc = isDark ? 'https://david.qa/images/dark.gif' : 'https://david.qa/images/light.gif';
          console.log(`Image source: ${imgSrc}`);
          toggle.src = imgSrc;
      }
  
      // Set initial theme
      setTheme();
  
      // Listen for system pref changes
      darkModeMediaQuery.addEventListener('change', e => {
          if (!storedPref) {
              // If no stored pref, follow system pref
              currentTheme = e.matches ? 'dark' : 'light'; 
              setTheme();
          } 
      });
  
      toggle.addEventListener('click', () => {
          // Switch theme
          currentTheme = currentTheme === 'dark' ? 'light' : 'dark';
  
          // Store preference
          sessionStorage.setItem('theme', currentTheme);
  
          // Set theme
          setTheme();
      });
  });  
  </textarea></span>

<h3>What's happening here?</h3>
<p><b>Lots!</b> First, this checks the user's system preference for dark or light theme (if any), stores that preference, and then displays it first. 
This only gets overridden if the user clicks the toggle, which then persists throughout the session across whatever other pages have this JavaScript running.
Each time a page is loaded, it will check the storage if there's an existing preference set, and then display that version.</p>
<p>Remember to replace <span class="inline-markup">https://david.qa/images/dark.gif</span> and <span class="inline-markup">https://david.qa/images/light.gif</span> with the URL location of your versions of the images!</p>

<h3>Changelog</h3>
<dl class="changelog">
<dt>2023.07.30</dt>
<dd>Greatly simplified, provided example site.</dd>
<dt>2023.07.28</dt>
<dd>Initial submission. Want to do more testing.</dd>
</dl>

</div><!-- End of Main -->

<!-- Footer -->
<footer>
<div id="fl">©2023 <a href="http://davidvkimball.com" target="_blank">David V. Kimball</a> • <a href="/about#credits">credits</a></div>
</footer><!-- End of Footer -->

</div><!-- End of Body -->

<!-- Top of Page -->
<a href="#" id="pagetop">▲top</a>

<!-- jquery -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="js/jquery.toggle.js"></script>
<script src="js/jquery.scroll.js"></script>
<script src="js/custom.js"></script>
</body>
</html>
